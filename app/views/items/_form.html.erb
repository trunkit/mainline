<%= form_for(:photo, url: [@item, :photos], multipart: true, html: { id: "photo-upload" }) do |f| %>
  <div class="separator">
    <span>Photos</span>
  </div>

  <div class="row photo">
    <div id="item-photos">
      <%= render(partial: "items/item_photo", collection: @item.photos, as: :photo) %>
    </div>

    <%= content_tag(:span, class: "button") do %>
      <span>Add New Photo(s)</span>
      <%= f.file_field(:url, multiple: true) %>
    <% end %>
  </div>
<% end if @item.persisted? %>

<%= form_for(@item) do |f| %>
  <div class="separator">
    <span>Supply a new item</span>
  </div>

  <div class="row brand-select">
    <%= f.select(:brand_id, @brands.map{|b| [b.name, b.id] } << ["(Add a New Brand)", -1], :prompt => "Designer") %>
  </div>

  <div class="row brand-add">
    <%= text_field_tag(:brand_name, "", placeholder: "Add a new Designer", class: "form-control") %>
    <%= content_tag(:span, button_tag("Add Designer", class: "btn btn-xs btn-primary"), class: "input-group-addon", id: "add-brand") %>
  </div>

  <div class="row">
      <%= f.text_field(:name, required: true, :placeholder => "Item Name", class: "required") %>
  </div>

  <div class="row">
    <%= f.text_field(:price, value: number_to_currency(@item.price, unit: ""), required: true, :placeholder => "Price", class: "required") %>
  </div>

  <div class="separator">
    <span>Required: Sizes &amp; Quantities</span>
  </div>

  <div class="row category-select">
    <%= f.select(:primary_category_id, @primary_categories.map{|c| [c.name, c.id] }, {:prompt => "Primary Category"}, required: true, class: "required") %>
  </div>

  <div class="row">
    <%= f.select(:secondary_category_id, [], {}, required: true, class: "required") %>
  </div>

  <div class="row">
    <%= f.text_area(:description, required: true, :placeholder => "Description", class: "required") %>
  </div>

  <div class="row">
      <%= f.text_area(:fit, :placeholder => "Fit") %>
  </div>

  <div class="row">
    <%= f.text_area(:construction, :placeholder => "Material") %>
  </div>

  <div class="separator">
    <span>Optional: Details</span>
  </div>

  <div class="row">
    <p>
      Enter the size and quantity for each item.<br>
      For "Size", type in size exactly as show on product tag. (e.g. S, Small, 1)
  </div>

  <%= render("items/quantity", item: @item) %>
  
  <div class="hideMobile">
    <div class="separator">
      <span>Model Measurements</span>
    </div>

    <div class="row">
      <div class="col-4">
        <%= f.label(:model_height, 'height') %>
        <%= f.text_field(:model_height) %>
      </div>

      <div class="col-4">
        <%= f.label(:model_chest, 'bust') %>
        <%= f.text_field(:model_chest) %>
      </div>

      <div class="col-4">
        <%= f.label(:model_waist, 'waist') %>
        <%= f.text_field(:model_waist) %>
      </div>

      <div class="col-4">
        <%= f.label(:model_hips, 'hips') %>
        <%= f.text_field(:model_hips) %>
      </div>
    </div>

    <div class="row">
      <div class="col-2">
        <%= f.label(:model_size, 'Model is wearing a ') %>
        <%= f.text_field(:model_size, placeholder: "small, medium, large, etc.") %>
      </div>
    </div>
 
    <div class="separator">
      <span>Optional: Weight &amp; Packaged Size</span>
    </div>

    <div class="row">
      <div class="col-2">
        <%= f.label(:weight) %>
        <%= f.text_field(:weight, required: true, class: "required") %>
      </div>

      <div class="col-2">
        <%= f.label(:packaging_width) %>
        <%= f.text_field(:packaging_width, required: true, class: "required") %>
      </div>
    </div>

    <div class="row">
      <div class="col-2">
        <%= f.label(:packaging_height) %>
        <%= f.text_field(:packaging_height, required: true, class: "required") %>
      </div>

      <div class="col-2">
        <%= f.label(:packaging_length) %>
        <%= f.text_field(:packaging_length, required: true, class: "required") %>
      </div>
    </div>
  </div>
  <hr>

  <%= submit_tag(@item.persisted? ? "Update Item" : "Add Item") %>
  <%= link_to("Remove Item", item_path, method: :delete, data: { confirm: "Are you sure that you want to remove #{@item.name}?" }, class: "remove") if @item.persisted? %>
<% end %>

<script>
$(function() {
  var secondaryCategories = <%= @secondary_categories.to_json.html_safe %>;
  SiteBindings.item.form(<%= @item.id || 'null' %>, <%= @item.secondary_category_id || 'null' %>, secondaryCategories);
  SiteBindings.item.brands();
});
</script>
